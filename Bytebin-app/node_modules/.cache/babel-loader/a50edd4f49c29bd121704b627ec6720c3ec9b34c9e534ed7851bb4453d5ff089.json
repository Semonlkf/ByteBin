{"ast":null,"code":"import \"core-js/modules/web.url-search-params.delete.js\";\nimport \"core-js/modules/web.url-search-params.has.js\";\nimport \"core-js/modules/web.url-search-params.size.js\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport Navigation from \"@/components/Navigation\";\nimport { getUserProfile, postProfile } from \"@/api/User\";\nimport UserActive from \"@/components/UserActive\";\nimport UserArticle from \"@/components/UserArticle\";\nimport UserSort from \"@/components/UserSort.vue\";\nconsole.log(fileList[0].url);\nexport default {\n  name: \"Profile\",\n  data() {\n    return {\n      id: '',\n      activeName: 'first',\n      user: {},\n      editProfile: {},\n      fileList: [],\n      editProfileDialog: false,\n      currentUserId: ''\n    };\n  },\n  methods: {\n    getUserInfo() {\n      let user = {};\n      if (this.id === this.currentUserId) {\n        user.avatar = this.$cookie.get(\"avatar\");\n        user.username = this.$cookie.get(\"username\");\n        user.nickname = this.$cookie.get(\"nickname\");\n        this.$set(this, 'user', user);\n      } else {\n        getUserProfile(this.id).then(res => {\n          user = res.data.user;\n          this.$set(this, 'user', user);\n        });\n      }\n    },\n    submitProfile(fileObject) {\n      let data = new FormData();\n      console.log(this.fileList[0]);\n      data.append(\"avatar\", this.fileList[0].raw);\n      data.append(\"nickname\", this.editProfile.nickname ? this.editProfile.nickname : this.user.nickname);\n      console.log(data.get(\"avatar\"));\n      postProfile(data).then(res => {\n        this.user.nickname = res.data.user.nickname;\n        this.user.avatar = res.data.user.avatar;\n        this.editProfileDialog = false;\n        this.$cookie.set(\"nickname\", this.user.nickname, 24 * 60 * 60 * 30);\n        this.$cookie.set(\"avatar\", this.user.avatar, 24 * 60 * 60 * 30);\n      });\n    },\n    handleChange(file, fileList) {\n      console.log(typeof fileList[0]);\n      this.fileList = fileList;\n      if (this.fileList.length > 1) {\n        this.fileList.splice(0, this.fileList.length - 1);\n      }\n      this.fileList[0].url = URL.createObjectURL(file.raw);\n      console.log(this.fileList[0].url);\n    },\n    handleAvatarSuccess(res, file) {},\n    beforeAvatarUpload(file) {\n      const isJPG = file.type === 'image/jpeg';\n      const isLt2M = file.size / 1024 / 1024 < 2;\n      if (!isJPG) {\n        this.$message.error('上传头像图片只能是 JPG 格式!');\n      }\n      if (!isLt2M) {\n        this.$message.error('上传头像图片大小不能超过 2MB!');\n      }\n      return isJPG && isLt2M;\n    }\n  },\n  components: {\n    'navigation': Navigation,\n    'active': UserActive,\n    'article-view': UserArticle,\n    'sort': UserSort\n  },\n  created() {\n    this.currentUserId = this.$cookie.get(\"id\");\n    this.id = this.$route.query.id;\n    this.getUserInfo();\n  }\n};","map":{"version":3,"names":["Navigation","getUserProfile","postProfile","UserActive","UserArticle","UserSort","console","log","fileList","url","name","data","id","activeName","user","editProfile","editProfileDialog","currentUserId","methods","getUserInfo","avatar","$cookie","get","username","nickname","$set","then","res","submitProfile","fileObject","FormData","append","raw","set","handleChange","file","length","splice","URL","createObjectURL","handleAvatarSuccess","beforeAvatarUpload","isJPG","type","isLt2M","size","$message","error","components","created","$route","query"],"sources":["src/views/Profile.vue"],"sourcesContent":["<template>\r\n  <el-container>\r\n    <el-main style=\"width: 80%;margin: 0 auto\">\r\n      <el-card style=\"height: 150px\">\r\n        <el-row style=\"height: 120px\">\r\n          <el-col :span=\"3\" style=\"text-align: left\">\r\n            <el-avatar\r\n                :fit=\"'cover'\"\r\n                :size=\"100\"\r\n                :src=\"user.avatar\"\r\n                shape=\"square\"\r\n            >\r\n            </el-avatar>\r\n          </el-col>\r\n          <el-col :span=\"10\" style=\"text-align: left;height: 100px\">\r\n            <el-row>\r\n              <span style=\"font-size: 20px;font-weight: bolder;line-height: 60px\"> {{ user.nickname }}</span>\r\n            </el-row>\r\n            <el-row>\r\n              <span style=\"color: darkgrey\">{{ '@' + user.username }}</span>\r\n            </el-row>\r\n          </el-col>\r\n          <el-col :span=\"11\" style=\"text-align: right;line-height: 150px\">\r\n            <el-button v-if=\"currentUserId===id\" icon=\"el-icon-user\" type=\"primary\" @click=\"editProfileDialog=true\">\r\n              编辑个人资料\r\n            </el-button>\r\n          </el-col>\r\n        </el-row>\r\n      </el-card>\r\n      <el-row>\r\n        <el-col :span=\"18\">\r\n          <el-tabs v-model=\"activeName\">\r\n            <el-tab-pane label=\"文章\" name=\"first\">\r\n              <article-view :user-id=\"id\"/>\r\n            </el-tab-pane>\r\n            <el-tab-pane label=\"收藏\" name=\"second\">\r\n              <sort :id=\"id\"/>\r\n            </el-tab-pane>\r\n          <!--\r\n            <el-tab-pane label=\"动态\" name=\"third\">\r\n              <active/>\r\n            </el-tab-pane>\r\n          -->\r\n          </el-tabs>\r\n        </el-col>\r\n        <el-col :span=\"6\">\r\n\r\n        </el-col>\r\n      </el-row>\r\n      <!-- 修改个人资料弹窗 -->\r\n      <el-dialog\r\n          :close-on-click-modal=\"false\"\r\n          :visible.sync=\"editProfileDialog\"\r\n          title=\"个人资料\"\r\n          width=\"30%\">\r\n        <el-form ref=\"form\" :model=\"editProfile\" label-width=\"80px\">\r\n          <el-row style=\"text-align:center\">\r\n            <el-upload\r\n                :auto-upload=\"false\"\r\n                :before-upload=\"beforeAvatarUpload\"\r\n                :data=\"{nickname:editProfile.nickname}\"\r\n                :file-list=\"fileList\"\r\n                :http-request=\"submitProfile\"\r\n                :on-change=\"handleChange\"\r\n                :on-success=\"handleAvatarSuccess\"\r\n                :show-file-list=\"false\"\r\n                action=\"#\" class=\"avatar-uploader\" name=\"avatar\"><img\r\n                v-if=\"fileList.length> 0\" :src=\"fileList[0].url\" class=\"avatar\">\r\n              <i v-else class=\"el-icon-plus avatar-uploader-icon\"></i>\r\n            </el-upload>\r\n          </el-row>\r\n          <el-form-item label=\"用户名\">\r\n            <el-input v-model=\"user.username\" disabled></el-input>\r\n          </el-form-item>\r\n          <el-form-item label=\"昵称\">\r\n            <el-input v-model=\"editProfile.nickname\" :placeholder=\"user.nickname\"></el-input>\r\n          </el-form-item>\r\n        </el-form>\r\n        <span slot=\"footer\" class=\"dialog-footer\">\r\n    <el-button @click=\"editProfileDialog = false\">取 消</el-button>\r\n    <el-button type=\"primary\" @click=\"submitProfile\">确 定</el-button>\r\n  </span>\r\n      </el-dialog>\r\n    </el-main>\r\n  </el-container>\r\n</template>\r\n\r\n\r\n<script>\r\nimport Navigation from \"@/components/Navigation\";\r\nimport {getUserProfile, postProfile} from \"@/api/User\";\r\nimport UserActive from \"@/components/UserActive\";\r\nimport UserArticle from \"@/components/UserArticle\";\r\nimport UserSort from \"@/components/UserSort.vue\";\r\n\r\nconsole.log(fileList[0].url)\r\n\r\nexport default {\r\n  name: \"Profile\",\r\n  data() {\r\n    return {\r\n      id: '',\r\n      activeName: 'first',\r\n      user: {},\r\n      editProfile: {},\r\n      fileList: [],\r\n      editProfileDialog: false,\r\n      currentUserId: ''\r\n    }\r\n  },\r\n  methods: {\r\n    getUserInfo() {\r\n      let user = {}\r\n      if (this.id === this.currentUserId) {\r\n        user.avatar = this.$cookie.get(\"avatar\");\r\n        user.username = this.$cookie.get(\"username\");\r\n        user.nickname = this.$cookie.get(\"nickname\");\r\n        this.$set(this, 'user', user);\r\n      } else {\r\n        getUserProfile(this.id).then((res) => {\r\n          user = res.data.user;\r\n          this.$set(this, 'user', user);\r\n        })\r\n      }\r\n    },\r\n    submitProfile(fileObject) {\r\n      let data = new FormData();\r\n      console.log(this.fileList[0])\r\n      data.append(\"avatar\", this.fileList[0].raw);\r\n      data.append(\"nickname\", this.editProfile.nickname ? this.editProfile.nickname : this.user.nickname)\r\n      console.log(data.get(\"avatar\"))\r\n      postProfile(data).then((res) => {\r\n        this.user.nickname = res.data.user.nickname;\r\n        this.user.avatar = res.data.user.avatar\r\n        this.editProfileDialog = false\r\n        this.$cookie.set(\"nickname\", this.user.nickname, 24 * 60 * 60 * 30)\r\n        this.$cookie.set(\"avatar\", this.user.avatar, 24 * 60 * 60 * 30)\r\n      })\r\n    },\r\n    handleChange(file, fileList) {\r\n      console.log(typeof fileList[0])\r\n      this.fileList = fileList;\r\n      if (this.fileList.length > 1) {\r\n        this.fileList.splice(0, this.fileList.length - 1);\r\n      }\r\n      this.fileList[0].url = URL.createObjectURL(file.raw)\r\n      console.log(this.fileList[0].url)\r\n    }\r\n    ,\r\n    handleAvatarSuccess(res, file) {\r\n\r\n    }\r\n    ,\r\n    beforeAvatarUpload(file) {\r\n      const isJPG = file.type === 'image/jpeg';\r\n      const isLt2M = file.size / 1024 / 1024 < 2;\r\n\r\n      if (!isJPG) {\r\n        this.$message.error('上传头像图片只能是 JPG 格式!');\r\n      }\r\n      if (!isLt2M) {\r\n        this.$message.error('上传头像图片大小不能超过 2MB!');\r\n      }\r\n      return isJPG && isLt2M;\r\n    }\r\n  }\r\n  ,\r\n  components: {\r\n    'navigation': Navigation,\r\n    'active': UserActive,\r\n    'article-view': UserArticle,\r\n    'sort': UserSort\r\n  },\r\n  created() {\r\n    this.currentUserId = this.$cookie.get(\"id\")\r\n    this.id = this.$route.query.id\r\n    this.getUserInfo()\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.avatar-uploader .el-upload {\r\n  border: 1px dashed #d9d9d9;\r\n  border-radius: 6px;\r\n  cursor: pointer;\r\n  position: relative;\r\n  overflow: hidden;\r\n}\r\n\r\n.avatar-uploader .el-upload:hover {\r\n  border-color: #409EFF;\r\n}\r\n\r\n.avatar-uploader-icon {\r\n  font-size: 28px;\r\n  color: #8c939d;\r\n  width: 178px;\r\n  height: 178px;\r\n  line-height: 178px;\r\n  text-align: center;\r\n}\r\n\r\n.avatar {\r\n  width: 178px;\r\n  height: 178px;\r\n  display: block;\r\n}\r\n</style>\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}