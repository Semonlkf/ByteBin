{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport { deleteArticle, getUserArticleByYear, getUserTimeline } from \"@/api/Article\";\nimport { getMonthAndDay } from \"@/util/tools\";\nexport default {\n  name: \"UserArticle\",\n  props: {\n    userId: String\n  },\n  data() {\n    return {\n      articles: [{\n        year: '',\n        records: []\n      }]\n    };\n  },\n  methods: {\n    getTime(date) {\n      return getMonthAndDay(date);\n    },\n    getTimeLine() {\n      getUserTimeline(this.userId).then(res => {\n        let year = res.data.year;\n        for (let i = 0; i < year.length; i++) {\n          if (!this.articles[i]) {\n            this.articles[i] = {};\n          }\n          this.articles[i].year = year[i];\n        }\n        if (this.articles) {\n          this.getNode(0);\n        }\n        this.$forceUpdate();\n      });\n    },\n    getNode(index) {\n      if (this.articles[index].year) {\n        getUserArticleByYear(this.userId, this.articles[index].year).then(res => {\n          this.articles[index].records = res.data.articles;\n          this.$forceUpdate();\n        });\n      }\n    },\n    del(index1, index2) {\n      let id = this.articles[index1].records[index2].id;\n      deleteArticle(id).then(res => {\n        if (res.code === 2001) {\n          this.articles[index1].records.splice(index2, 1);\n          this.$forceUpdate();\n          this.$notify({\n            title: \"Bloggy\",\n            message: res.message,\n            type: \"success\",\n            duration: 1000\n          });\n        } else {\n          this.$notify({\n            title: \"Bloggy\",\n            message: res.message,\n            type: \"error\",\n            duration: 1000\n          });\n        }\n      });\n    },\n    toDetail(id) {\n      this.$router.push(\"/detail?id=\" + id);\n    },\n    toEdit(id) {\n      this.$router.push(\"/write?id=\" + id);\n    }\n  },\n  created() {\n    this.getTimeLine(this.userId);\n  }\n};","map":{"version":3,"names":["deleteArticle","getUserArticleByYear","getUserTimeline","getMonthAndDay","name","props","userId","String","data","articles","year","records","methods","getTime","date","getTimeLine","then","res","i","length","getNode","$forceUpdate","index","del","index1","index2","id","code","splice","$notify","title","message","type","duration","toDetail","$router","push","toEdit","created"],"sources":["src/components/UserArticle.vue"],"sourcesContent":["<template>\r\n  <el-container>\r\n    <el-main>\r\n      <el-empty v-if=\"articles[0].year===''\" description=\"空空如也\"></el-empty>\r\n      <div v-for=\"(article,index) in articles\">\r\n        <el-link @click.native=\"getNode(index)\">\r\n          <div class=\"year\">{{ article.year }}</div>\r\n        </el-link>\r\n        <el-timeline :reverse=\"true\">\r\n          <el-timeline-item\r\n              v-for=\"(record,index2) in article.records\" :timestamp=\"getTime(record.createTime)\"\r\n              placement=\"top\"\r\n              class = \"el-timeline-item__tail\">\r\n            <el-card>\r\n              <el-row style=\"width: 100%;height: 40px\">\r\n                <el-col :span=\"18\" style=\"text-align: left\">\r\n                  <el-link style=\"font-size: 16px\" @click=\"toDetail(record.id)\"> {{ record.title }}</el-link>\r\n                </el-col>\r\n                <el-col :span=\"6\" style=\"text-align: right;\">\r\n                  <el-button icon=\"el-icon-edit\" type=\"primary\" @click=\"toEdit(record.id)\"></el-button>\r\n                  <el-button icon=\"el-icon-delete\" type=\"danger\" @click=\"del(index,index2)\"></el-button>\r\n                </el-col>\r\n              </el-row>\r\n\r\n            </el-card>\r\n\r\n          </el-timeline-item>\r\n        </el-timeline>\r\n      </div>\r\n    </el-main>\r\n  </el-container>\r\n</template>\r\n\r\n<script>\r\nimport {deleteArticle, getUserArticleByYear, getUserTimeline} from \"@/api/Article\";\r\nimport {getMonthAndDay} from \"@/util/tools\";\r\n\r\nexport default {\r\n  name: \"UserArticle\",\r\n  props: {\r\n    userId: String\r\n  },\r\n  data() {\r\n    return {\r\n      articles: [\r\n        {\r\n          year: '',\r\n          records: []\r\n        }\r\n      ]\r\n    }\r\n  },\r\n  methods: {\r\n    getTime(date) {\r\n      return getMonthAndDay(date);\r\n    },\r\n    getTimeLine() {\r\n      getUserTimeline(this.userId).then((res) => {\r\n        let year = res.data.year\r\n        for (let i = 0; i < year.length; i++) {\r\n          if (!this.articles[i]) {\r\n            this.articles[i] = {}\r\n          }\r\n          this.articles[i].year = year[i]\r\n        }\r\n        if (this.articles) {\r\n          this.getNode(0)\r\n        }\r\n        this.$forceUpdate()\r\n      })\r\n    },\r\n    getNode(index) {\r\n      if (this.articles[index].year) {\r\n        getUserArticleByYear(this.userId, this.articles[index].year).then((res) => {\r\n          this.articles[index].records = res.data.articles\r\n          this.$forceUpdate()\r\n        })\r\n      }\r\n    },\r\n    del(index1, index2) {\r\n      let id = this.articles[index1].records[index2].id\r\n      deleteArticle(id).then((res) => {\r\n        if (res.code === 2001) {\r\n          this.articles[index1].records.splice(index2, 1)\r\n          this.$forceUpdate()\r\n          this.$notify({\r\n            title: \"Bloggy\",\r\n            message: res.message,\r\n            type: \"success\",\r\n            duration: 1000\r\n          })\r\n        } else {\r\n          this.$notify({\r\n            title: \"Bloggy\",\r\n            message: res.message,\r\n            type: \"error\",\r\n            duration: 1000\r\n          })\r\n        }\r\n      })\r\n    },\r\n    toDetail(id) {\r\n      this.$router.push(\"/detail?id=\" + id);\r\n    },\r\n    toEdit(id) {\r\n      this.$router.push(\"/write?id=\" + id);\r\n\r\n    }\r\n  },\r\n  created() {\r\n    this.getTimeLine(this.userId)\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.year {\r\n  font-size: 20px;\r\n  margin-bottom: 10px;\r\n}\r\n\r\n.el-timeline-item__tail{\r\n  \r\n  padding-bottom: 40px;\r\n  height: 65px;\r\n}\r\n</style>"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAkCA,SAAAA,aAAA,EAAAC,oBAAA,EAAAC,eAAA;AACA,SAAAC,cAAA;AAEA;EACAC,IAAA;EACAC,KAAA;IACAC,MAAA,EAAAC;EACA;EACAC,KAAA;IACA;MACAC,QAAA,GACA;QACAC,IAAA;QACAC,OAAA;MACA;IAEA;EACA;EACAC,OAAA;IACAC,QAAAC,IAAA;MACA,OAAAX,cAAA,CAAAW,IAAA;IACA;IACAC,YAAA;MACAb,eAAA,MAAAI,MAAA,EAAAU,IAAA,CAAAC,GAAA;QACA,IAAAP,IAAA,GAAAO,GAAA,CAAAT,IAAA,CAAAE,IAAA;QACA,SAAAQ,CAAA,MAAAA,CAAA,GAAAR,IAAA,CAAAS,MAAA,EAAAD,CAAA;UACA,UAAAT,QAAA,CAAAS,CAAA;YACA,KAAAT,QAAA,CAAAS,CAAA;UACA;UACA,KAAAT,QAAA,CAAAS,CAAA,EAAAR,IAAA,GAAAA,IAAA,CAAAQ,CAAA;QACA;QACA,SAAAT,QAAA;UACA,KAAAW,OAAA;QACA;QACA,KAAAC,YAAA;MACA;IACA;IACAD,QAAAE,KAAA;MACA,SAAAb,QAAA,CAAAa,KAAA,EAAAZ,IAAA;QACAT,oBAAA,MAAAK,MAAA,OAAAG,QAAA,CAAAa,KAAA,EAAAZ,IAAA,EAAAM,IAAA,CAAAC,GAAA;UACA,KAAAR,QAAA,CAAAa,KAAA,EAAAX,OAAA,GAAAM,GAAA,CAAAT,IAAA,CAAAC,QAAA;UACA,KAAAY,YAAA;QACA;MACA;IACA;IACAE,IAAAC,MAAA,EAAAC,MAAA;MACA,IAAAC,EAAA,QAAAjB,QAAA,CAAAe,MAAA,EAAAb,OAAA,CAAAc,MAAA,EAAAC,EAAA;MACA1B,aAAA,CAAA0B,EAAA,EAAAV,IAAA,CAAAC,GAAA;QACA,IAAAA,GAAA,CAAAU,IAAA;UACA,KAAAlB,QAAA,CAAAe,MAAA,EAAAb,OAAA,CAAAiB,MAAA,CAAAH,MAAA;UACA,KAAAJ,YAAA;UACA,KAAAQ,OAAA;YACAC,KAAA;YACAC,OAAA,EAAAd,GAAA,CAAAc,OAAA;YACAC,IAAA;YACAC,QAAA;UACA;QACA;UACA,KAAAJ,OAAA;YACAC,KAAA;YACAC,OAAA,EAAAd,GAAA,CAAAc,OAAA;YACAC,IAAA;YACAC,QAAA;UACA;QACA;MACA;IACA;IACAC,SAAAR,EAAA;MACA,KAAAS,OAAA,CAAAC,IAAA,iBAAAV,EAAA;IACA;IACAW,OAAAX,EAAA;MACA,KAAAS,OAAA,CAAAC,IAAA,gBAAAV,EAAA;IAEA;EACA;EACAY,QAAA;IACA,KAAAvB,WAAA,MAAAT,MAAA;EACA;AACA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}