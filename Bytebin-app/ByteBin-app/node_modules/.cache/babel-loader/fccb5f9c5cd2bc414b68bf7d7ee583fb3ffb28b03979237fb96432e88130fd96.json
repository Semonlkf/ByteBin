{"ast":null,"code":"import \"core-js/modules/web.url-search-params.delete.js\";\nimport \"core-js/modules/web.url-search-params.has.js\";\nimport \"core-js/modules/web.url-search-params.size.js\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport Navigation from \"@/components/Navigation\";\nimport { getUserProfile, postProfile } from \"@/api/User\";\nimport UserActive from \"@/components/UserActive\";\nimport UserArticle from \"@/components/UserArticle\";\nimport UserSort from \"@/components/UserSort.vue\";\nexport default {\n  name: \"Profile\",\n  data() {\n    return {\n      id: '',\n      activeName: 'first',\n      user: {},\n      editProfile: {},\n      fileList: [],\n      editProfileDialog: false,\n      currentUserId: ''\n    };\n  },\n  methods: {\n    getUserInfo() {\n      let user = {};\n      if (this.id === this.currentUserId) {\n        user.avatar = this.$cookie.get(\"avatar\");\n        user.username = this.$cookie.get(\"username\");\n        user.nickname = this.$cookie.get(\"nickname\");\n        this.$set(this, 'user', user);\n      } else {\n        getUserProfile(this.id).then(res => {\n          user = res.data.user;\n          this.$set(this, 'user', user);\n        });\n      }\n    },\n    submitProfile(fileObject) {\n      let data = new FormData();\n      console.log(this.fileList[0]);\n      data.append(\"avatar\", this.fileList[0].raw);\n      data.append(\"nickname\", this.editProfile.nickname ? this.editProfile.nickname : this.user.nickname);\n      console.log(data.get(\"avatar\"));\n      postProfile(data).then(res => {\n        this.user.nickname = res.data.user.nickname;\n        this.user.avatar = res.data.user.avatar;\n        this.editProfileDialog = false;\n        this.$cookie.set(\"nickname\", this.user.nickname, 24 * 60 * 60 * 30);\n        this.$cookie.set(\"avatar\", this.user.avatar, 24 * 60 * 60 * 30);\n      });\n    },\n    handleChange(file, fileList) {\n      console.log(typeof fileList[0]);\n      this.fileList = fileList;\n      if (this.fileList.length > 1) {\n        this.fileList.splice(0, this.fileList.length - 1);\n      }\n      this.fileList[0].url = URL.createObjectURL(file.raw);\n    },\n    handleAvatarSuccess(res, file) {},\n    beforeAvatarUpload(file) {\n      const isJPG = file.type === 'image/jpeg';\n      const isLt2M = file.size / 1024 / 1024 < 2;\n      if (!isJPG) {\n        this.$message.error('上传头像图片只能是 JPG 格式!');\n      }\n      if (!isLt2M) {\n        this.$message.error('上传头像图片大小不能超过 2MB!');\n      }\n      return isJPG && isLt2M;\n    }\n  },\n  components: {\n    'navigation': Navigation,\n    'active': UserActive,\n    'article-view': UserArticle,\n    'sort': UserSort\n  },\n  created() {\n    this.currentUserId = this.$cookie.get(\"id\");\n    this.id = this.$route.query.id;\n    this.getUserInfo();\n  }\n};","map":{"version":3,"names":["Navigation","getUserProfile","postProfile","UserActive","UserArticle","UserSort","name","data","id","activeName","user","editProfile","fileList","editProfileDialog","currentUserId","methods","getUserInfo","avatar","$cookie","get","username","nickname","$set","then","res","submitProfile","fileObject","FormData","console","log","append","raw","set","handleChange","file","length","splice","url","URL","createObjectURL","handleAvatarSuccess","beforeAvatarUpload","isJPG","type","isLt2M","size","$message","error","components","created","$route","query"],"sources":["src/views/Profile.vue"],"sourcesContent":["<template>\n  <el-container>\n    <el-main style=\"width: 80%;margin: 0 auto\">\n      <el-card style=\"height: 150px\">\n        <el-row style=\"height: 120px\">\n          <el-col :span=\"3\" style=\"text-align: left\">\n            <el-avatar\n                :fit=\"'cover'\"\n                :size=\"100\"\n                :src=\"user.avatar\"\n                shape=\"square\"\n            >\n            </el-avatar>\n          </el-col>\n          <el-col :span=\"10\" style=\"text-align: left;height: 100px\">\n            <el-row>\n              <span style=\"font-size: 20px;font-weight: bolder;line-height: 60px\"> {{ user.nickname }}</span>\n            </el-row>\n            <el-row>\n              <span style=\"color: darkgrey\">{{ '@' + user.username }}</span>\n            </el-row>\n          </el-col>\n          <el-col :span=\"11\" style=\"text-align: right;line-height: 150px\">\n            <el-button v-if=\"currentUserId===id\" icon=\"el-icon-user\" type=\"primary\" @click=\"editProfileDialog=true\">\n              编辑个人资料\n            </el-button>\n          </el-col>\n        </el-row>\n      </el-card>\n      <el-row>\n        <el-col :span=\"18\">\n          <el-tabs v-model=\"activeName\">\n            <el-tab-pane label=\"动态\" name=\"first\">\n              <active/>\n            </el-tab-pane>\n            <el-tab-pane label=\"文章\" name=\"second\">\n              <article-view :user-id=\"id\"/>\n            </el-tab-pane>\n            <el-tab-pane label=\"收藏\" name=\"third\">\n              <sort :id=\"id\"/>\n            </el-tab-pane>\n          </el-tabs>\n        </el-col>\n        <el-col :span=\"6\">\n\n        </el-col>\n      </el-row>\n      <!-- 修改个人资料弹窗 -->\n      <el-dialog\n          :close-on-click-modal=\"false\"\n          :visible.sync=\"editProfileDialog\"\n          title=\"个人资料\"\n          width=\"30%\">\n        <el-form ref=\"form\" :model=\"editProfile\" label-width=\"80px\">\n          <el-row style=\"text-align:center\">\n            <el-upload\n                :auto-upload=\"false\"\n                :before-upload=\"beforeAvatarUpload\"\n                :data=\"{nickname:editProfile.nickname}\"\n                :file-list=\"fileList\"\n                :http-request=\"submitProfile\"\n                :on-change=\"handleChange\"\n                :on-success=\"handleAvatarSuccess\"\n                :show-file-list=\"false\"\n                action=\"#\" class=\"avatar-uploader\" name=\"avatar\"><img\n                v-if=\"fileList.length> 0\" :src=\"fileList[0].url\" class=\"avatar\">\n              <i v-else class=\"el-icon-plus avatar-uploader-icon\"></i>\n            </el-upload>\n          </el-row>\n          <el-form-item label=\"用户名\">\n            <el-input v-model=\"user.username\" disabled></el-input>\n          </el-form-item>\n          <el-form-item label=\"昵称\">\n            <el-input v-model=\"editProfile.nickname\" :placeholder=\"user.nickname\"></el-input>\n          </el-form-item>\n        </el-form>\n        <span slot=\"footer\" class=\"dialog-footer\">\n    <el-button @click=\"editProfileDialog = false\">取 消</el-button>\n    <el-button type=\"primary\" @click=\"submitProfile\">确 定</el-button>\n  </span>\n      </el-dialog>\n    </el-main>\n  </el-container>\n</template>\n\n<script>\nimport Navigation from \"@/components/Navigation\";\nimport {getUserProfile, postProfile} from \"@/api/User\";\nimport UserActive from \"@/components/UserActive\";\nimport UserArticle from \"@/components/UserArticle\";\nimport UserSort from \"@/components/UserSort.vue\";\n\nexport default {\n  name: \"Profile\",\n  data() {\n    return {\n      id: '',\n      activeName: 'first',\n      user: {},\n      editProfile: {},\n      fileList: [],\n      editProfileDialog: false,\n      currentUserId: ''\n    }\n  },\n  methods: {\n    getUserInfo() {\n      let user = {}\n      if (this.id === this.currentUserId) {\n        user.avatar = this.$cookie.get(\"avatar\");\n        user.username = this.$cookie.get(\"username\");\n        user.nickname = this.$cookie.get(\"nickname\");\n        this.$set(this, 'user', user);\n      } else {\n        getUserProfile(this.id).then((res) => {\n          user = res.data.user;\n          this.$set(this, 'user', user);\n        })\n      }\n    },\n    submitProfile(fileObject) {\n      let data = new FormData();\n      console.log(this.fileList[0])\n      data.append(\"avatar\", this.fileList[0].raw);\n      data.append(\"nickname\", this.editProfile.nickname ? this.editProfile.nickname : this.user.nickname)\n      console.log(data.get(\"avatar\"))\n      postProfile(data).then((res) => {\n        this.user.nickname = res.data.user.nickname;\n        this.user.avatar = res.data.user.avatar\n        this.editProfileDialog = false\n        this.$cookie.set(\"nickname\", this.user.nickname, 24 * 60 * 60 * 30)\n        this.$cookie.set(\"avatar\", this.user.avatar, 24 * 60 * 60 * 30)\n      })\n    },\n    handleChange(file, fileList) {\n      console.log(typeof fileList[0])\n      this.fileList = fileList;\n      if (this.fileList.length > 1) {\n        this.fileList.splice(0, this.fileList.length - 1);\n      }\n      this.fileList[0].url = URL.createObjectURL(file.raw)\n    }\n    ,\n    handleAvatarSuccess(res, file) {\n\n    }\n    ,\n    beforeAvatarUpload(file) {\n      const isJPG = file.type === 'image/jpeg';\n      const isLt2M = file.size / 1024 / 1024 < 2;\n\n      if (!isJPG) {\n        this.$message.error('上传头像图片只能是 JPG 格式!');\n      }\n      if (!isLt2M) {\n        this.$message.error('上传头像图片大小不能超过 2MB!');\n      }\n      return isJPG && isLt2M;\n    }\n  }\n  ,\n  components: {\n    'navigation': Navigation,\n    'active': UserActive,\n    'article-view': UserArticle,\n    'sort': UserSort\n  },\n  created() {\n    this.currentUserId = this.$cookie.get(\"id\")\n    this.id = this.$route.query.id\n    this.getUserInfo()\n  }\n}\n</script>\n\n<style scoped>\n.avatar-uploader .el-upload {\n  border: 1px dashed #d9d9d9;\n  border-radius: 6px;\n  cursor: pointer;\n  position: relative;\n  overflow: hidden;\n}\n\n.avatar-uploader .el-upload:hover {\n  border-color: #409EFF;\n}\n\n.avatar-uploader-icon {\n  font-size: 28px;\n  color: #8c939d;\n  width: 178px;\n  height: 178px;\n  line-height: 178px;\n  text-align: center;\n}\n\n.avatar {\n  width: 178px;\n  height: 178px;\n  display: block;\n}\n</style>\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsFA,OAAAA,UAAA;AACA,SAAAC,cAAA,EAAAC,WAAA;AACA,OAAAC,UAAA;AACA,OAAAC,WAAA;AACA,OAAAC,QAAA;AAEA;EACAC,IAAA;EACAC,KAAA;IACA;MACAC,EAAA;MACAC,UAAA;MACAC,IAAA;MACAC,WAAA;MACAC,QAAA;MACAC,iBAAA;MACAC,aAAA;IACA;EACA;EACAC,OAAA;IACAC,YAAA;MACA,IAAAN,IAAA;MACA,SAAAF,EAAA,UAAAM,aAAA;QACAJ,IAAA,CAAAO,MAAA,QAAAC,OAAA,CAAAC,GAAA;QACAT,IAAA,CAAAU,QAAA,QAAAF,OAAA,CAAAC,GAAA;QACAT,IAAA,CAAAW,QAAA,QAAAH,OAAA,CAAAC,GAAA;QACA,KAAAG,IAAA,eAAAZ,IAAA;MACA;QACAT,cAAA,MAAAO,EAAA,EAAAe,IAAA,CAAAC,GAAA;UACAd,IAAA,GAAAc,GAAA,CAAAjB,IAAA,CAAAG,IAAA;UACA,KAAAY,IAAA,eAAAZ,IAAA;QACA;MACA;IACA;IACAe,cAAAC,UAAA;MACA,IAAAnB,IAAA,OAAAoB,QAAA;MACAC,OAAA,CAAAC,GAAA,MAAAjB,QAAA;MACAL,IAAA,CAAAuB,MAAA,gBAAAlB,QAAA,IAAAmB,GAAA;MACAxB,IAAA,CAAAuB,MAAA,kBAAAnB,WAAA,CAAAU,QAAA,QAAAV,WAAA,CAAAU,QAAA,QAAAX,IAAA,CAAAW,QAAA;MACAO,OAAA,CAAAC,GAAA,CAAAtB,IAAA,CAAAY,GAAA;MACAjB,WAAA,CAAAK,IAAA,EAAAgB,IAAA,CAAAC,GAAA;QACA,KAAAd,IAAA,CAAAW,QAAA,GAAAG,GAAA,CAAAjB,IAAA,CAAAG,IAAA,CAAAW,QAAA;QACA,KAAAX,IAAA,CAAAO,MAAA,GAAAO,GAAA,CAAAjB,IAAA,CAAAG,IAAA,CAAAO,MAAA;QACA,KAAAJ,iBAAA;QACA,KAAAK,OAAA,CAAAc,GAAA,kBAAAtB,IAAA,CAAAW,QAAA;QACA,KAAAH,OAAA,CAAAc,GAAA,gBAAAtB,IAAA,CAAAO,MAAA;MACA;IACA;IACAgB,aAAAC,IAAA,EAAAtB,QAAA;MACAgB,OAAA,CAAAC,GAAA,QAAAjB,QAAA;MACA,KAAAA,QAAA,GAAAA,QAAA;MACA,SAAAA,QAAA,CAAAuB,MAAA;QACA,KAAAvB,QAAA,CAAAwB,MAAA,SAAAxB,QAAA,CAAAuB,MAAA;MACA;MACA,KAAAvB,QAAA,IAAAyB,GAAA,GAAAC,GAAA,CAAAC,eAAA,CAAAL,IAAA,CAAAH,GAAA;IACA;IAEAS,oBAAAhB,GAAA,EAAAU,IAAA,GAEA;IAEAO,mBAAAP,IAAA;MACA,MAAAQ,KAAA,GAAAR,IAAA,CAAAS,IAAA;MACA,MAAAC,MAAA,GAAAV,IAAA,CAAAW,IAAA;MAEA,KAAAH,KAAA;QACA,KAAAI,QAAA,CAAAC,KAAA;MACA;MACA,KAAAH,MAAA;QACA,KAAAE,QAAA,CAAAC,KAAA;MACA;MACA,OAAAL,KAAA,IAAAE,MAAA;IACA;EACA;EAEAI,UAAA;IACA,cAAAhD,UAAA;IACA,UAAAG,UAAA;IACA,gBAAAC,WAAA;IACA,QAAAC;EACA;EACA4C,QAAA;IACA,KAAAnC,aAAA,QAAAI,OAAA,CAAAC,GAAA;IACA,KAAAX,EAAA,QAAA0C,MAAA,CAAAC,KAAA,CAAA3C,EAAA;IACA,KAAAQ,WAAA;EACA;AACA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}