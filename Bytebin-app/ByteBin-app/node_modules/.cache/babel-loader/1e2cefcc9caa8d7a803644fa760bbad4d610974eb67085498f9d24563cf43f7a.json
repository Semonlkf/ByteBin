{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport { cancelLikeArticle, getArticleDetail, likeArticle } from \"@/api/Article\";\nimport Navigation from \"@/components/Navigation\";\nimport Unfold from \"@/components/Unfold\";\nimport { getCount, getDate } from \"@/util/tools\";\nimport Comment from \"@/components/Comment\";\nimport { append, cancelSort, createSort, getByUser } from \"@/api/Sort\";\nimport AuthorIntroduce from \"@/components/AuthorIntroduce.vue\";\nimport RelatedRead from \"@/components/RelatedRead.vue\";\nexport default {\n  name: \"ArticleDetail\",\n  data() {\n    return {\n      id: String,\n      article: {},\n      relation: '+ 关注',\n      flag: 0,\n      time: '',\n      type: 0,\n      dialogVisible: false,\n      choose: String,\n      userId: String,\n      sorts: [],\n      sortTitle: '',\n      sortPlaceholder: '新建收藏夹'\n    };\n  },\n  methods: {\n    getDetail(id) {\n      getArticleDetail(id).then(res => {\n        this.article = res.data.article;\n        console.log(this.article.isLike);\n        this.article.createTime = new Date(this.article.createTime).toLocaleString();\n        if (this.article.updateTime == null) {\n          this.time = this.article.createTime;\n        } else {\n          this.article.updateTime = new Date(this.article.createTime).toLocaleString();\n          this.time = this.article.updateTime;\n        }\n        this.article.views = getCount(this.article.views);\n        this.article.likeNum = getCount(this.article.likeNum);\n        this.article.comments = getCount(this.article.comments);\n        console.log(this.article);\n      });\n    },\n    getHtml() {\n      return this.$refs.md.$render(this.article.content);\n    },\n    changeRelation() {\n      let that = this;\n      if (that.flag == 0) {\n        that.flag = 1;\n        this.relation = '关注中';\n      } else {\n        that.flag = 0;\n        this.relation = \"+ 关注\";\n      }\n    },\n    like() {\n      if (this.article.isLike) {\n        cancelLikeArticle(this.id);\n        this.article.isLike = false;\n        this.article.likeNum -= 1;\n      } else {\n        likeArticle(this.id);\n        this.article.isLike = true;\n        this.article.likeNum += 1;\n      }\n    },\n    getDate(date) {\n      return getDate(date);\n    },\n    changeType() {\n      this.type = 1;\n      this.type = 0;\n    },\n    searchByTag(tag) {\n      tag = '#' + tag + '#';\n      this.$router.push(\"/search?keyword=\" + encodeURIComponent(tag));\n    },\n    getSorts() {\n      this.dialogVisible = true;\n      getByUser(this.userId).then(res => {\n        this.sorts = res.data.sorts;\n      });\n    },\n    createSort() {\n      createSort(this.sortTitle).then(res => {\n        if (res.code === 2001) {\n          this.sortTitle = '';\n          this.sortPlaceholder = '新建收藏夹';\n          this.sorts.push(res.data.sort);\n        } else {\n          this.$notify({\n            title: \"Bloggy\",\n            message: res.message,\n            type: \"error\",\n            duration: 1000\n          });\n        }\n      });\n    },\n    appendArticleToSort() {\n      append(this.choose, this.id).then(res => {\n        if (res.code === 2001) {\n          this.article.isSort = true;\n          this.dialogVisible = false;\n        } else {\n          this.$notify({\n            title: \"Bloggy\",\n            message: res.message,\n            type: \"error\",\n            duration: 1000\n          });\n        }\n      });\n    },\n    cancelSort() {\n      cancelSort(this.id).then(res => {\n        if (res.code === 2001) {\n          this.article.isSort = false;\n        } else {\n          this.$notify({\n            title: \"Bloggy\",\n            message: res.message,\n            type: \"error\",\n            duration: 1000\n          });\n        }\n      });\n    },\n    chooseSortAction() {\n      if (this.article.isSort) {\n        this.cancelSort();\n      } else {\n        this.getSorts();\n      }\n    }\n  },\n  components: {\n    'navigation': Navigation,\n    'unfold': Unfold,\n    'comment': Comment,\n    'author-introduce': AuthorIntroduce,\n    'related-read': RelatedRead\n  },\n  beforeMount() {\n    let id = this.$route.query.id;\n    this.id = id;\n    this.getDetail(id);\n  },\n  created() {\n    this.userId = this.$cookie.get(\"id\");\n  }\n};","map":{"version":3,"names":["cancelLikeArticle","getArticleDetail","likeArticle","Navigation","Unfold","getCount","getDate","Comment","append","cancelSort","createSort","getByUser","AuthorIntroduce","RelatedRead","name","data","id","String","article","relation","flag","time","type","dialogVisible","choose","userId","sorts","sortTitle","sortPlaceholder","methods","getDetail","then","res","console","log","isLike","createTime","Date","toLocaleString","updateTime","views","likeNum","comments","getHtml","$refs","md","$render","content","changeRelation","that","like","date","changeType","searchByTag","tag","$router","push","encodeURIComponent","getSorts","code","sort","$notify","title","message","duration","appendArticleToSort","isSort","chooseSortAction","components","beforeMount","$route","query","created","$cookie","get"],"sources":["src/views/ArticleDetail.vue"],"sourcesContent":["<template>\n  <el-container>\n    <el-main style=\"margin: 80px auto;width: 90%;\">\n      <el-row style=\"display: flex\">\n       <div style=\"width: 76%\">\n         <el-card id=\"main\">\n           <el-row><span style=\"font-size: 24px;font-weight: bold\">{{article.title}}</span></el-row>\n           <el-row style=\"margin-top: 4%;margin-bottom: 4%\">\n             <el-breadcrumb separator=\"|\">\n               <el-breadcrumb-item class=\"text-item\" style=\"font-weight: bolder\">{{ article.userVo.nickname }}</el-breadcrumb-item>\n               <el-breadcrumb-item class=\"text-item\">\n               {{article.views}}阅读\n               </el-breadcrumb-item>\n               <el-breadcrumb-item class=\"text-item\">\n                 {{article.likeNum}}点赞\n               </el-breadcrumb-item>\n             </el-breadcrumb>\n           </el-row>\n           <div id=\"content\">\n             <mavon-editor\n                 ref=\"md\"\n                 v-model=\"article.content\"\n                 :editable=\"false\"\n                 :subfield=\"false\"\n                 :toolbarsFlag=\"false\"\n                 defaultOpen=\"preview\"\n                 style=\"z-index: 5;border: none\"\n             ></mavon-editor>\n           </div>\n         </el-card>\n         <div id=\"tag\">\n           <el-card>\n             <div slot=\"header\" class=\"clearfix\">\n               <el-row>\n                 <el-col :span=\"8\" style=\"margin-top: 10px\"><span>最后编辑于:{{ time }}</span></el-col>\n                 <el-col :span=\"16\" style=\"text-align: right;\">\n                   <el-button circle @click=\"like\">\n                     <i :class=\"{'el-icon-like':!article.isLike,'el-icon-liked':article.isLike}\"></i>\n                   </el-button>\n                   <span>{{ article.likeNum }}</span>\n                   <el-button circle>\n                     <i class=\"el-icon-comment\"></i>\n\n                   </el-button>\n                   <span>{{ article.comments }}</span>\n                   <el-button circle @click=\"chooseSortAction\">\n                     <i :class=\"{'el-icon-sort':!article.isSort,'el-icon-sorted':article.isSort}\" class=\"el-icon-sort\"></i>\n                   </el-button>\n                 </el-col>\n               </el-row>\n               <el-dialog\n                   :visible.sync=\"dialogVisible\"\n                   title=\"收藏\"\n                   width=\"20%\"\n               >\n                 <div>\n                   <el-container>\n                     <el-main>\n                       <el-radio-group v-model=\"choose\">\n                         <el-row v-for=\"item in sorts\" style=\"margin-top: 8px\">\n                           <el-radio :label=\"item.id\">{{ item.title }}</el-radio>\n                         </el-row>\n                       </el-radio-group>\n                     </el-main>\n                     <el-footer>\n                       <el-input v-model=\"sortTitle\" maxlength=\"15\" placeholder=\"新建收藏夹\">\n                         <el-button slot=\"append\" icon=\"el-icon-circle-plus\" @click=\"createSort\"></el-button>\n                       </el-input>\n                     </el-footer>\n                   </el-container>\n                 </div>\n                 <span slot=\"footer\" class=\"dialog-footer\">\n    <el-button @click=\"dialogVisible = false\">取 消</el-button>\n    <el-button type=\"primary\" @click=\"appendArticleToSort\">确 定</el-button>\n  </span>\n               </el-dialog>\n             </div>\n\n             <el-link v-for=\"tag in article.tags\" @click.native=\"searchByTag(tag)\">\n               <el-tag>{{ tag }}\n               </el-tag>\n             </el-link>\n           </el-card>\n         </div>\n         <el-card class=\"box-card\" style=\"margin: 0 auto;\">\n           <div slot=\"header\" class=\"clearfix\" style=\"height: 30px\" @click=\"changeType\">\n             <span style=\"float: left;font-weight: bolder;font-size: 20px\">评论</span>\n           </div>\n           <comment :id=\"article.id\" :author=\"article.userVo.id\" :type=\"type\"/>\n         </el-card>\n       </div>\n          <div style=\"width: 22%;margin-left: 2%\">\n            <el-card >\n              <author-introduce :author=\"article.userVo\"/>\n              <el-divider/>\n              <h3>相关阅读</h3>\n              <related-read :tags=\"article.tags\" :size=\"5\"/>\n            </el-card>\n          </div>\n\n\n\n\n      </el-row>\n\n    </el-main>\n\n  </el-container>\n\n</template>\n\n<script>\nimport {cancelLikeArticle, getArticleDetail, likeArticle} from \"@/api/Article\";\nimport Navigation from \"@/components/Navigation\";\nimport Unfold from \"@/components/Unfold\";\nimport {getCount, getDate} from \"@/util/tools\";\nimport Comment from \"@/components/Comment\";\nimport {append, cancelSort, createSort, getByUser} from \"@/api/Sort\";\nimport AuthorIntroduce from \"@/components/AuthorIntroduce.vue\";\nimport RelatedRead from \"@/components/RelatedRead.vue\";\n\nexport default {\n  name: \"ArticleDetail\",\n  data() {\n    return {\n      id: String,\n      article: {},\n      relation: '+ 关注',\n      flag: 0,\n      time: '',\n      type: 0,\n      dialogVisible: false,\n      choose: String,\n      userId: String,\n      sorts: [],\n      sortTitle: '',\n      sortPlaceholder: '新建收藏夹',\n\n    }\n  },\n  methods: {\n    getDetail(id) {\n      getArticleDetail(id).then((res) => {\n        this.article = res.data.article\n        console.log(this.article.isLike)\n        this.article.createTime = (new Date(this.article.createTime)).toLocaleString()\n        if (this.article.updateTime == null) {\n          this.time = this.article.createTime\n        } else {\n          this.article.updateTime = (new Date(this.article.createTime)).toLocaleString()\n          this.time = this.article.updateTime\n        }\n        this.article.views = getCount(this.article.views);\n        this.article.likeNum = getCount(this.article.likeNum);\n        this.article.comments = getCount(this.article.comments)\n        console.log(this.article)\n      })\n    },\n    getHtml() {\n      return this.$refs.md.$render(this.article.content)\n    },\n    changeRelation() {\n      let that = this\n      if (that.flag == 0) {\n        that.flag = 1\n        this.relation = '关注中'\n      } else {\n        that.flag = 0;\n        this.relation = \"+ 关注\"\n      }\n    },\n    like() {\n      if (this.article.isLike) {\n        cancelLikeArticle(this.id)\n        this.article.isLike = false\n        this.article.likeNum -= 1\n      } else {\n        likeArticle(this.id)\n        this.article.isLike = true\n        this.article.likeNum += 1\n      }\n    },\n    getDate(date) {\n      return getDate(date);\n    },\n    changeType() {\n      this.type = 1;\n      this.type = 0;\n    },\n    searchByTag(tag) {\n      tag = '#' + tag + '#'\n      this.$router.push(\"/search?keyword=\" + encodeURIComponent(tag));\n    },\n    getSorts() {\n      this.dialogVisible = true;\n      getByUser(this.userId).then((res) => {\n        this.sorts = res.data.sorts\n      })\n    },\n    createSort() {\n      createSort(this.sortTitle).then((res) => {\n        if (res.code === 2001) {\n          this.sortTitle = ''\n          this.sortPlaceholder = '新建收藏夹'\n          this.sorts.push(res.data.sort)\n        } else {\n          this.$notify({\n            title: \"Bloggy\",\n            message: res.message,\n            type: \"error\",\n            duration: 1000\n          })\n        }\n      })\n    },\n    appendArticleToSort() {\n      append(this.choose, this.id).then((res) => {\n        if (res.code === 2001) {\n          this.article.isSort = true\n          this.dialogVisible = false\n        } else {\n          this.$notify({\n            title: \"Bloggy\",\n            message: res.message,\n            type: \"error\",\n            duration: 1000\n          })\n        }\n      })\n    },\n    cancelSort() {\n      cancelSort(this.id).then((res) => {\n        if (res.code === 2001) {\n          this.article.isSort = false\n        } else {\n          this.$notify({\n            title: \"Bloggy\",\n            message: res.message,\n            type: \"error\",\n            duration: 1000\n          })\n        }\n      })\n    },\n    chooseSortAction() {\n      if (this.article.isSort) {\n        this.cancelSort()\n      } else {\n        this.getSorts()\n      }\n    }\n  },\n  components: {\n    'navigation': Navigation,\n    'unfold': Unfold,\n    'comment': Comment,\n    'author-introduce':AuthorIntroduce,\n    'related-read':RelatedRead\n  },\n  beforeMount() {\n    let id = this.$route.query.id\n    this.id = id\n    this.getDetail(id)\n  },\n  created() {\n    this.userId = this.$cookie.get(\"id\")\n  }\n}\n</script>\n\n<style scoped>\nli {\n  list-style-type: none;\n  float: left;\n  text-align: left;\n}\n\n.el-link + .el-link {\n  margin-left: 4px;\n}\n\nli + li {\n  margin-left: 10px;\n}\n\n#content {\n  margin-top: 10px;\n}\n\nspan + span {\n  margin-left: 10px;\n}\n\n#userInfo {\n  margin-top: 20px;\n}\n\n#tag {\n  padding-top: 10px;\n  text-align: left;\n  margin: 0 auto 20px;\n}\n\n.comments {\n  margin-left: 10px;\n}\n\n::v-deep .el-icon-view {\n  background: url('@/static/images/view.svg') center no-repeat;\n  font-size: 20px;\n  background-size: cover;\n}\n\n::v-deep .el-icon-view:before {\n  content: \"替\";\n  font-size: 20px;\n  visibility: hidden;\n}\n\n::v-deep .el-icon-like {\n  background: url('@/static/images/like.svg') center no-repeat;\n  font-size: 20px;\n  background-size: cover;\n}\n\n::v-deep .el-icon-like:before {\n  content: \"替\";\n  font-size: 20px;\n  visibility: hidden;\n}\n\n::v-deep .el-icon-liked {\n  background: url('@/static/images/like_fill.svg') center no-repeat;\n  font-size: 20px;\n  background-size: cover;\n}\n\n::v-deep .el-icon-liked:before {\n  content: \"替\";\n  font-size: 20px;\n  visibility: hidden;\n}\n\n::v-deep .el-icon-comment {\n  background: url('@/static/images/interactive.svg') center no-repeat;\n  font-size: 20px;\n  background-size: cover;\n}\n\n::v-deep .el-icon-comment:before {\n  content: \"替\";\n  font-size: 20px;\n  visibility: hidden;\n}\n\n::v-deep .el-icon-sort {\n  background: url('@/static/images/document.svg') center no-repeat;\n  font-size: 20px;\n  background-size: cover;\n}\n\n::v-deep .el-icon-sort:before {\n  content: \"替\";\n  font-size: 20px;\n  visibility: hidden;\n}\n\n::v-deep .el-icon-sorted {\n  background: url('@/static/images/document_fill.svg') center no-repeat;\n  font-size: 20px;\n  background-size: cover;\n}\n\n::v-deep .el-icon-sorted:before {\n  content: \"替\";\n  font-size: 20px;\n  visibility: hidden;\n}\n\n.el-button {\n  border: none;\n  margin-left: 10px;\n}\n</style>\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}